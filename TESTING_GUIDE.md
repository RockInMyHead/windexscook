# üß™ **–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è AI —à–µ—Ñ-–ø–æ–≤–∞—Ä–∞**

## üìã **–û–±–∑–æ—Ä**

–°–æ–∑–¥–∞–Ω –≤—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã AI —à–µ—Ñ-–ø–æ–≤–∞—Ä–∞ —Å –≥–æ–ª–æ—Å–æ–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º. –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## üéØ **–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã**

### **1. –ì–æ–ª–æ—Å–æ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ**
- ‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ (Web Speech API + OpenAI Whisper)
- ‚úÖ –°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ (OpenAI TTS)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –∏ barge-in

### **2. AI —à–µ—Ñ-–ø–æ–≤–∞—Ä**
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ü–µ–ø—Ç–æ–≤ —á–µ—Ä–µ–∑ GPT-4-turbo
- ‚úÖ Streaming –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ fallback

### **3. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –±—Ä–∞—É–∑–µ—Ä–æ–≤**
- ‚úÖ Safari v18 –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (Web Speech API fallback)
- ‚úÖ Chrome/Firefox –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚úÖ Graceful degradation –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
- ‚úÖ Progressive enhancement

### **4. –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π —á–µ—Ä–µ–∑ YooKassa
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ localStorage

### **5. Email –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏**
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ welcome –ø–∏—Å–µ–º
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ SMTP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ HTML –∏ plain text —à–∞–±–ª–æ–Ω—ã

## üóÇÔ∏è **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤**

```
tests/
‚îú‚îÄ‚îÄ smoke/                # üöÄ –ë—ã—Å—Ç—Ä—ã–µ smoke —Ç–µ—Å—Ç—ã (–≥–æ—Ç–æ–≤–æ)
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ browser-compatibility.test.ts  # üåê –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –±—Ä–∞—É–∑–µ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ openai-service.test.ts         # ü§ñ OpenAI API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ email-service.test.ts          # üìß Email —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ VoiceCallNew.test.tsx          # üé§ –ì–æ–ª–æ—Å–æ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îî‚îÄ‚îÄ pages/
‚îÇ       ‚îî‚îÄ‚îÄ PaymentSuccess.test.tsx        # üí≥ –ü–ª–∞—Ç–µ–∂–∏
‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îî‚îÄ‚îÄ api-integration.skip.test.js       # üîó API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ e2e/
‚îÇ   ‚îî‚îÄ‚îÄ voice-chat-flow.skip.test.js       # üåê E2E —Å—Ü–µ–Ω–∞—Ä–∏–∏
‚îú‚îÄ‚îÄ performance/
‚îÇ   ‚îî‚îÄ‚îÄ performance.test.js                # ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
‚îî‚îÄ‚îÄ backend/                               # üñ•Ô∏è Backend API (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)
```

## ‚úÖ **–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**

### **üî• Smoke Tests** (`tests/smoke/smoke.test.js`)
- –°–∏—Å—Ç–µ–º–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ (server, database, env vars)
- –ò–º–ø–æ—Ä—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π
- –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ**

### **üåê Browser Compatibility** (`tests/frontend/utils/browser-compatibility.test.ts`)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ Chrome, Firefox, Safari
- MediaRecorder –∏ Web Speech API
- Fallback –ª–æ–≥–∏–∫–∞ –¥–ª—è Safari
- Graceful degradation
- **–°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ**

### **üé§ Voice Interface** (`tests/frontend/components/VoiceCallNew.test.tsx`)
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —á–∞—Ç–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (listening, processing, speaking)
- Web Speech API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- MediaRecorder fallback
- Error handling
- **–°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ**

### **ü§ñ OpenAI Service** (`tests/frontend/services/openai-service.test.ts`)
- API requests –∏ responses
- Streaming responses
- Error handling
- Rate limiting
- Token limits
- **–°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ**

### **üìß Email Service** (`tests/frontend/services/email-service.test.ts`)
- –û—Ç–ø—Ä–∞–≤–∫–∞ email
- HTML –∏ text —à–∞–±–ª–æ–Ω—ã
- SMTP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- Error handling
- **–°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ**

### **üí≥ Payment System** (`tests/frontend/pages/PaymentSuccess.test.tsx`)
- –°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–µ–π
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
- LocalStorage recovery
- Error states
- Email notifications
- **–°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ**

### **üîó Integration Tests** (`tests/integration/api-integration.skip.test.js`)
- API endpoints testing
- Request/response validation
- Cross-service communication
- **–°—Ç–∞—Ç—É—Å: üìù –°–æ–∑–¥–∞–Ω–æ (–Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –¥–æ—Ä–∞–±–æ—Ç–∫–µ)**

### **üåê E2E Tests** (`tests/e2e/voice-chat-flow.skip.test.js`)
- –ü–æ–ª–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π
- Browser automation (Puppeteer)
- Voice chat flow
- **–°—Ç–∞—Ç—É—Å: üìù –°–æ–∑–¥–∞–Ω–æ (–Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ)**

### **‚ö° Performance Tests** (`tests/performance/performance.test.js`)
- Response time monitoring
- Memory usage tracking
- Concurrent operations
- Large payload handling
- **–°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ**

## üèÉ‚Äç‚ôÇÔ∏è **–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤**

### –ë—ã—Å—Ç—Ä—ã–µ smoke —Ç–µ—Å—Ç—ã
```bash
npm run test:smoke
```

### –í—Å–µ frontend —Ç–µ—Å—Ç—ã
```bash
npm run test:frontend
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
```bash
npm run test:critical
```

### –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
```bash
npm run test:coverage
```

## üìä **–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞**

### –¶–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞:** >80% statements, >75% branches
- **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API:** <500ms
- **–í—Ä–µ–º—è –≥–æ–ª–æ—Å–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:** <2s
- **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:** <3s
- **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤:** >95%

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- Memory usage: <100MB –ø—Ä–∏ –Ω–∞–≥—Ä—É–∑–∫–µ
- Concurrent users: >100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π
- Error rate: <0.1%

## üõ†Ô∏è **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

- **Jest** - Test runner –∏ assertions
- **React Testing Library** - Component testing
- **jsdom** - Browser environment simulation
- **Supertest** - API testing
- **Puppeteer** - E2E testing
- **Mock Service Worker** - API mocking

## üîß **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env.test`):
```env
# OpenAI
VITE_OPENAI_API_KEY=test-key

# Email
SMTP_HOST=localhost
SMTP_PORT=1025

# Database
DATABASE_URL=sqlite::memory:
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```json
{
  "jest": "^30.2.0",
  "jest-environment-jsdom": "^30.0.0",
  "@testing-library/react": "^13.4.0",
  "@testing-library/jest-dom": "^5.16.5",
  "supertest": "^7.1.4",
  "puppeteer": "^21.0.0"
}
```

## üéØ **–ö–ª—é—á–µ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

### **1. –ì–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç —Å AI —à–µ—Ñ-–ø–æ–≤–∞—Ä–æ–º**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –ú–∏–∫—Ä–æ—Ñ–æ–Ω ‚Üí –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ ‚Üí OpenAI ‚Üí –°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ ‚Üí –ê—É–¥–∏–æ –≤—ã–≤–æ–¥
```

### **2. –ü–ª–∞—Ç–µ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å**
```
–í—ã–±–æ—Ä –ø–æ–¥–ø–∏—Å–∫–∏ ‚Üí YooKassa ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞ ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
```

### **3. Safari —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**
```
Safari v18 ‚Üí Web Speech API ‚Üí OpenAI Whisper fallback ‚Üí Voice interaction
```

### **4. Error recovery**
```
–°–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ ‚Üí Graceful degradation ‚Üí Offline mode ‚Üí Retry logic
```

## üìà **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

### ‚úÖ **–†–∞–±–æ—Ç–∞—é—â–∏–µ —Ç–µ—Å—Ç—ã:**
- Browser compatibility detection
- Voice interface state management
- Payment processing flow
- Email service integration
- Performance monitoring
- Error handling

### üìù **–ù—É–∂–¥–∞—é—â–∏–µ –≤ –¥–æ—Ä–∞–±–æ—Ç–∫–µ:**
- E2E —Ç–µ—Å—Ç—ã (Puppeteer setup)
- Integration —Ç–µ—Å—Ç—ã (API mocking)
- Backend —Ç–µ—Å—Ç—ã (database integration)

## üöÄ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é**

### CI/CD Pipeline:
```yaml
- Smoke tests (fast)
- Unit tests (all)
- Integration tests (staging)
- E2E tests (production-like)
- Performance tests (load testing)
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- Test execution time tracking
- Coverage reports
- Flaky test detection
- Performance regression alerts

---

## üìû **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏**

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Jest –æ–∫—Ä—É–∂–µ–Ω–∏–µ** –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è
2. **–î–æ–±–∞–≤–∏—Ç—å Puppeteer** –¥–ª—è E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å CI/CD** –ø–∞–π–ø–ª–∞–π–Ω–æ–º
4. **–î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**
5. **–°–æ–∑–¥–∞—Ç—å performance baseline** –º–µ—Ç—Ä–∏–∫–∏

---

## üéâ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–°–æ–∑–¥–∞–Ω —Å–æ–ª–∏–¥–Ω—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã AI —à–µ—Ñ-–ø–æ–≤–∞—Ä–∞. –û—Å–Ω–æ–≤–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∫—Ä—ã—Ç—ã unit –∏ integration —Ç–µ—Å—Ç–∞–º–∏. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é —Å confidence –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞.
